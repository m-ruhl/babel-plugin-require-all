"use strict";function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}var fs=require("fs"),modulePath=require("path"),rootPath=process.cwd(),wrapPath=function(a){var b=new RegExp("^".concat(modulePath.sep,"|\\.")),c=new RegExp("".concat(modulePath.sep,"$"));return function(){return b.test(a)?"":modulePath.sep}()+a+function(){return c.test(a)?"":modulePath.sep}()},validName=function(a){if("string"!=typeof a)return!1;if(!a.trim())return!1;try{return Function(a,"var ".concat(a," = 1")),!0}catch(a){return!1}};module.exports=function(a){var b=a.types;return{visitor:{CallExpression:function CallExpression(a,c){if("requireAll"===a.node.callee.name){var d=c.opts.ignorePath,e=function(){return void 0===d?"":d}(),f=c.file.opts.filename,g=c.file.opts.filenameRelative;g||(g=f.replace(rootPath,""));var h=modulePath.dirname(g),i=_slicedToArray(a.node.arguments,2),j=i[0];j=function(){return void 0===j?{}:j}();var k=j.value,l=function(){return void 0===k?"./":k}(),m=i[1],n=function(){return void 0!==m&&m}(),o=wrapPath(l),p=modulePath.join(rootPath,h,o);if(null!=e&&""!==e&&(p=p.split(wrapPath(e)).join(modulePath.sep)),!fs.existsSync(p))throw a.buildCodeFrameError("Path `".concat(o,"` doesn't exist"));var q=modulePath.join(p,modulePath.basename(g));console.log(q),a.replaceWith(b.objectExpression(fs.readdirSync(p).filter(function(a){var b=modulePath.join(p,a);return b!==q||n}).map(function(a){var c="".concat(o).concat(a),d=c.split(modulePath.sep).reverse(),e=_slicedToArray(d,1),f=e[0],g=f.split("."),h=_slicedToArray(g,1);return f=h[0],b.objectProperty(validName(f)&&b.identifier(f)||b.stringLiteral(f),b.callExpression(b.identifier("require"),[b.stringLiteral(c)]))})))}}}}};