"use strict";function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}var fs=require("fs"),modulePath=require("path"),rootPath=process.cwd(),wrapPath=function(a){var b=new RegExp("^".concat(modulePath.sep)),c=new RegExp("".concat(modulePath.sep,"$"));return function(){return b.test(a)?"":modulePath.sep}()+a+function(){return c.test(a)?"":modulePath.sep}()};module.exports=function(a){var b=a.types;return{visitor:{CallExpression:function CallExpression(a,c){if("requireAll"===a.node.callee.name){var d=c.opts.ignorePath,e=function(){return void 0===d?"":d}(),f=c.file.opts.filename,g=c.file.opts.filenameRelative;g||(g=f.replace(rootPath,""));var h=modulePath.dirname(g),i=_slicedToArray(a.node.arguments,1),j=i[0];j=function(){return void 0===j?{}:j}();var k=j.value,l=function(){return void 0===k?"./":k}(),m=function(){return l.lastIndexOf(modulePath.sep)===l.length-1?l:l+modulePath.sep}(),n=modulePath.join(rootPath,h,m);if(null!=e&&""!==e&&(n=n.split(wrapPath(e)).join(modulePath.sep)),!fs.existsSync(n))throw a.buildCodeFrameError("Path `".concat(m,"` doesn't exist"));a.replaceWith(b.objectExpression(fs.readdirSync(n).map(function(a){var c="".concat(m).concat(a),d=c.split(modulePath.sep).reverse(),e=_slicedToArray(d,1),f=e[0],g=f.split("."),h=_slicedToArray(g,1);return f=h[0],b.objectProperty(b.identifier(f),b.callExpression(b.identifier("require"),[b.stringLiteral(c)]))})))}}}}};