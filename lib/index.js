"use strict";function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){var c=function(){return null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"]}();if(null!=c){var d,e,f=[],g=!0,h=!1;try{for(c=c.call(a);!(g=(d=c.next()).done)&&(f.push(d.value),!(b&&f.length===b));g=!0);}catch(a){h=!0,e=a}finally{try{g||null==c["return"]||c["return"]()}finally{if(h)throw e}}return f}}function _arrayWithHoles(a){if(Array.isArray(a))return a}var fs=require("fs"),modulePath=require("path"),rootPath=process.cwd(),wrapPath=function(a){var b=new RegExp("^".concat(modulePath.sep,"|\\.")),c=new RegExp("".concat(modulePath.sep,"$"));return function(){return b.test(a)?"":modulePath.sep}()+a+function(){return c.test(a)?"":modulePath.sep}()},validName=function(a){if("string"!=typeof a)return!1;if(!a.trim())return!1;try{return Function(a,"var ".concat(a," = 1")),!0}catch(a){return!1}};module.exports=function(a){var b=a.types;return{visitor:{CallExpression:function CallExpression(a,c){if("requireAll"===a.node.callee.name){var d=c.opts.ignorePath,e=function(){return void 0===d?"":d}(),f=c.file.opts.filename,g=c.file.opts.filenameRelative;g||(g=f.replace(rootPath,""));var h=modulePath.dirname(g),i=_slicedToArray(a.node.arguments,2),j=i[0];j=function(){return void 0===j?{}:j}();var k=j.value,l=function(){return void 0===k?"./":k}(),m=i[1],n=function(){return void 0!==m&&m}(),o=wrapPath(l),p=modulePath.join(rootPath,h,o);if(null!=e&&""!==e&&(p=p.split(wrapPath(e)).join(modulePath.sep)),!fs.existsSync(p))throw a.buildCodeFrameError("Path `".concat(o,"` doesn't exist"));var q=modulePath.join(p,modulePath.basename(g));console.log(q),a.replaceWith(b.objectExpression(fs.readdirSync(p,{withFileTypes:!0}).filter(function(a){var b=modulePath.join(p,a.name);return a.isFile()&&(b!==q||n)}).map(function(a){var c="".concat(o).concat(a.name),d=c.split(modulePath.sep).reverse(),e=_slicedToArray(d,1),f=e[0],g=f.split("."),h=_slicedToArray(g,1);return f=h[0],b.objectProperty(validName(f)&&b.identifier(f)||b.stringLiteral(f),b.callExpression(b.identifier("require"),[b.stringLiteral(c)]))})))}}}}};